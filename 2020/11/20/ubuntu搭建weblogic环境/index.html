<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>
    ubuntu搭建weblogic环境,配合IDEA调试 |
    
    Mount4in</title>
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<script src="/js/pace.min.js"></script>

<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Mount4in" type="application/atom+xml">
</head>

<body>
<main class="content">
  <section class="outer">
  

<article id="post-ubuntu搭建weblogic环境" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ubuntu搭建weblogic环境,配合IDEA调试
    </h1>
  
  




      </header>
    

    
      <div class="article-meta">
        <a href="/2020/11/20/ubuntu%E6%90%AD%E5%BB%BAweblogic%E7%8E%AF%E5%A2%83/" class="article-date">
  <time datetime="2020-11-20T02:21:52.000Z" itemprop="datePublished">2020-11-20</time>
</a>
        
      </div>
    

    
      
    <div class="tocbot"></div>





    

    <div class="article-entry" itemprop="articleBody">
      


      

      
        
        <p>之前都是利用docker搭建weblogic的漏洞环境，这里记录一下在ubuntu中搭建weblogic环境</p>
<a id="more"></a>

<blockquote>
<p>  jdk  ubuntu 18.04.3 (虚拟机磁盘空间选大一点（60G）)</p>
</blockquote>
<h2 id="0x00-jdk安装"><a href="#0x00-jdk安装" class="headerlink" title="0x00 jdk安装"></a>0x00 jdk安装</h2><p>手动下载压缩包安装oracle Java JDK</p>
<ul>
<li>创建目录:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir &#x2F;usr&#x2F;lib&#x2F;jvm</span><br></pre></td></tr></table></figure>

<ul>
<li>解压缩到该目录:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf jdk-7u21-linux-x64.gz</span><br></pre></td></tr></table></figure>

<ul>
<li>修改环境变量:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi ~&#x2F;.bashrc</span><br></pre></td></tr></table></figure>

<ul>
<li>在文件末尾追加下面内容：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#set oracle jdk environment</span><br><span class="line">#export JAVA_HOME&#x3D;&#x2F;usr&#x2F;lib&#x2F;jvm&#x2F;jdk1.8.0_121  ## 这里要注意目录要换成自己解压的jdk 目录</span><br><span class="line">export JAVA_HOME&#x3D;&#x2F;usr&#x2F;lib&#x2F;jvm&#x2F;jdk1.7.0_21  ## 这里要注意目录要换成自己解压的jdk 目录</span><br><span class="line">export JRE_HOME&#x3D;$&#123;JAVA_HOME&#125;&#x2F;jre  </span><br><span class="line">export CLASSPATH&#x3D;.:$&#123;JAVA_HOME&#125;&#x2F;lib:$&#123;JRE_HOME&#125;&#x2F;lib  </span><br><span class="line">export PATH&#x3D;$&#123;JAVA_HOME&#125;&#x2F;bin:$PATH</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/zhu1361/article/details/103592544" target="_blank" rel="noopener">https://blog.csdn.net/zhu1361/article/details/103592544</a>  jdk9+</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#set oracle jdk environment</span><br><span class="line">JAVA_HOME&#x3D;&#x2F;usr&#x2F;lib&#x2F;jvm&#x2F;jdk-9.0.4  ## 这里要注意目录要换成自己解压的jdk 目录</span><br><span class="line">JRE_HOME&#x3D;$JAVA_HOME </span><br><span class="line">CLASSPATH&#x3D;$JAVA_HOME&#x2F;lib</span><br><span class="line">PATH&#x3D;$JRE_HOME&#x2F;bin:$JAVA_HOME&#x2F;bin:$PATH</span><br><span class="line">export PATH JAVA_HOME CLASSPATH</span><br></pre></td></tr></table></figure>

<ul>
<li>使环境变量马上生效：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source ~&#x2F;.bashrc</span><br><span class="line">java -version</span><br></pre></td></tr></table></figure>

<img src="/2020/11/20/ubuntu%E6%90%AD%E5%BB%BAweblogic%E7%8E%AF%E5%A2%83/image-20201120131639241.png" alt="image-20201120131639241" style="zoom:150%;">

<hr>
<p>如果你安装了多个版本的jdk，你可以通过修改<code>~/.bashrc</code>文件后面的<code>JAVA_HOME</code></p>
<h2 id="0x01-weblogic"><a href="#0x01-weblogic" class="headerlink" title="0x01 weblogic"></a>0x01 weblogic</h2><p>看了好多帖子都说要新建一个weblogic用户，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo useradd -r -m -s &#x2F;bin&#x2F;bash weblogic</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参数的意思：<br>-r 建立系统账号<br>-m 自动建立用户的登入目录<br>-s /bin/bash 指定用户登入后所使用的shell</p>
</blockquote>
<p>修改密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd weblogic</span><br></pre></td></tr></table></figure>

<p>新建用户后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java -jar fmw_12.2.1.3.0_wls.jar</span><br><span class="line">报错Exception in thread &quot;main&quot; java.awt.AWTError: Can&#39;t connect to X11 window server using &#39;:0&#39; as the value of the DISPLAY variable.</span><br></pre></td></tr></table></figure>

<p>切换回原用户就可以了，搜了一下原因好像是因为weblogic用户不能打开window界面。我们这里搭建的本意就是为了复现漏洞，也可以不新建用户，直接在当前用户安装，</p>
<p><code>wls-silent.xml</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bea-installer</span>&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">input-fields</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">data-value</span> <span class="attr">name</span>=<span class="string">"BEAHOME"</span> <span class="attr">value</span>=<span class="string">"/home/weblogic/Oracle/Middleware"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">data-value</span> <span class="attr">name</span>=<span class="string">"USER_INSTALL_DIR"</span> <span class="attr">value</span>=<span class="string">"/home/weblogic/Oracle/Middleware"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">data-value</span> <span class="attr">name</span>=<span class="string">"COMPONENT_PATHS"</span> <span class="attr">value</span>=<span class="string">"WebLogic Server/Core Application Server|WebLogic Server/Administration Console|WebLogic Server/Configuration Wizard and Upgrade Framework|WebLogic Server/Web 2.0 HTTP Pub-Sub Server|WebLogic Server/WebLogic JDBC Drivers|WebLogic Server/Third Party JDBC Drivers|WebLogic Server/WebLogic Server Clients|WebLogic Server/WebLogic Web Server Plugins|WebLogic Server/UDDI and Xquery Support|WebLogic Server/Server Examples"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">data-value</span> <span class="attr">name</span>=<span class="string">"INSTALL_NODE_MANAGER_SERVICE"</span> <span class="attr">value</span>=<span class="string">"no"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">data-value</span> <span class="attr">name</span>=<span class="string">"INSTALL_SHORTCUT_IN_ALL_USERS_FOLDER"</span> <span class="attr">value</span>=<span class="string">"no"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">data-value</span> <span class="attr">name</span>=<span class="string">"LOCAL_JVMS"</span> <span class="attr">value</span>=<span class="string">"/usr/lib/jvm/jdk1.6.0_45"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">input-fields</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bea-installer</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar wls1036_generic.jar -mode=silent -silent_xml=wls-silent.xml</span><br></pre></td></tr></table></figure>

<p><code>create-wls-domain.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Default domain 'base_domain' to be created inside the Docker image for WLS</span></span><br><span class="line"><span class="comment"># ==============================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Open default domain template</span></span><br><span class="line"><span class="comment"># ======================</span></span><br><span class="line">readTemplate(<span class="string">"/home/weblogic/Oracle/Middleware/wlserver_10.3/common/templates/domains/wls.jar"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure the Administration Server and SSL port.</span></span><br><span class="line"><span class="comment"># =========================================================</span></span><br><span class="line">cd(<span class="string">'Servers/AdminServer'</span>)</span><br><span class="line">set(<span class="string">'ListenAddress'</span>,<span class="string">''</span>)</span><br><span class="line">set(<span class="string">'ListenPort'</span>, <span class="number">7001</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define the user password for weblogic</span></span><br><span class="line"><span class="comment"># =====================================</span></span><br><span class="line">cd(<span class="string">'/'</span>)</span><br><span class="line">cd(<span class="string">'Security/base_domain/User/weblogic'</span>)</span><br><span class="line">cmo.setPassword(<span class="string">'Oracle@123'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Write the domain and close the domain template</span></span><br><span class="line"><span class="comment"># ==============================================</span></span><br><span class="line">setOption(<span class="string">'OverwriteDomain'</span>, <span class="string">'true'</span>)</span><br><span class="line"></span><br><span class="line">writeDomain(<span class="string">'/home/weblogic/Oracle/Middleware/user_projects/domains/base_domain'</span>)</span><br><span class="line">closeTemplate()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Exit WLST</span></span><br><span class="line"><span class="comment"># =========</span></span><br><span class="line">exit()</span><br></pre></td></tr></table></figure>

<p><code>chmod +x create-wls-domain.py</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/Oracle/Middleware/wlserver_10.3/common/bin$./wlst.sh -skipWLSModuleScanning /home/weblogic/Oracle/create-wls-domain.py</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/Oracle/Middleware/user_projects/domains/base_domain/bin$ ./startWebLogic.sh</span><br></pre></td></tr></table></figure>

<p><img src="/2020/11/20/ubuntu%E6%90%AD%E5%BB%BAweblogic%E7%8E%AF%E5%A2%83/image-20201202144942741.png" alt="image-20201202144942741"></p>
<h2 id="0x02-idea调试"><a href="#0x02-idea调试" class="headerlink" title="0x02 idea调试"></a>0x02 idea调试</h2><p>首先修改<code>~/Oracle/Middleware/user_projects/domains/base_domain/bin/setDomainEnv.sh</code></p>
<p>在文件头加如下内容：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">debugFlag=<span class="string">"true"</span></span><br><span class="line"><span class="built_in">export</span> debugFlag</span><br></pre></td></tr></table></figure>

<img src="/2020/11/20/ubuntu%E6%90%AD%E5%BB%BAweblogic%E7%8E%AF%E5%A2%83/image-20201203110506200.png" alt="image-20201203110506200" style="zoom: 200%;">

<p>然后运行<code>./startWebLogic.sh</code></p>
<p>然后将<code>~/Oracle/Middleware/wlserver_10.3</code>，目录复制到本机，然后利用<code>find ./ -name *.jar -exec cp {} ./weblogic_jar/ \;</code>在<code>~/Oracle/Middleware/</code>目录下搜索<code>jar</code>文件然后复制到weblogic_jar目录，然后在本地打开IDEA，将<code>weblogic_jar</code>添加到libraries，</p>
<p><img src="/2020/11/20/ubuntu%E6%90%AD%E5%BB%BAweblogic%E7%8E%AF%E5%A2%83/image-20201203111249352.png" alt="image-20201203111249352"></p>
<p>将jdk改为和jdk6</p>
<p><img src="/2020/11/20/ubuntu%E6%90%AD%E5%BB%BAweblogic%E7%8E%AF%E5%A2%83/image-20201203111330965.png" alt="image-20201203111330965"></p>
<p>然后在下断点，开启调试</p>
<p><img src="/2020/11/20/ubuntu%E6%90%AD%E5%BB%BAweblogic%E7%8E%AF%E5%A2%83/image-20201203111434909.png" alt="image-20201203111434909"></p>
<p>burp发包</p>
<p><img src="/2020/11/20/ubuntu%E6%90%AD%E5%BB%BAweblogic%E7%8E%AF%E5%A2%83/image-20201203111505573.png" alt="image-20201203111505573"></p>
<p>可以看到成功。</p>
<p><img src="/2020/11/20/ubuntu%E6%90%AD%E5%BB%BAweblogic%E7%8E%AF%E5%A2%83/image-20201203111519281.png" alt="image-20201203111519281"></p>
<p><a href="https://blog.csdn.net/zbj18314469395/article/details/86064849" target="_blank" rel="noopener">https://blog.csdn.net/zbj18314469395/article/details/86064849</a></p>
<p><a href="https://starky99.com/ubuntu16-install-weblogic10.3.6/" target="_blank" rel="noopener">Ubuntu16.04命令行安装Weblogic</a></p>
<p><a href="https://blog.csdn.net/qq_36205145/article/details/70473545" target="_blank" rel="noopener">在ubuntu 16.04上安装weblogic 12c</a></p>
<p><a href="https://www.oracle.com/middleware/technologies/weblogic-server-installers-downloads.html" target="_blank" rel="noopener">weblogic下载</a></p>
<p><a href="jianshu.com/p/75344ad2aaff">ubuntu建立新用户没有家目录的问题与授予sudo权限</a></p>
<p><a href="https://hub.docker.com/layers/vulhub/weblogic/10.3.6.0-2017/images/sha256-275ec19477cfda389dc1c42158033e7e8c650dd4cba9f090ca0ba673902b73c9?context=explore" target="_blank" rel="noopener">vulhub/weblogic:10.3.6.0-2017</a></p>

      
    </div>
  </div>
  <!-- 要添加的内容 -->
  
    <div>
        <ul class="post-copyright">
          <li class="post-copyright-author">
          <strong>作者:  </strong>Mount4in</a>
          </li>
          <li class="post-copyright-link">
          <strong>文章链接:  </strong>
          <a href="/2020/11/20/ubuntu搭建weblogic环境/" target="_blank" title="ubuntu搭建weblogic环境,配合IDEA调试">http://mount4in.github.io/2020/11/20/ubuntu搭建weblogic环境/</a>
          </li>
          <li class="post-copyright-license">
            <strong>版权声明:   </strong>
            本网站所有文章除特别声明外,均采用 <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
            许可协议。转载请注明出处!
          </li>
        </ul>
      <div>

  
  <!---->
    <footer class="article-footer">
      <a data-url="http://mount4in.github.io/2020/11/20/ubuntu%E6%90%AD%E5%BB%BAweblogic%E7%8E%AF%E5%A2%83/" data-id="clg20p5lg000m14uv3i39cq8q"
         class="article-share-link">Share</a>
      
    </footer>



  
    
  <nav class="article-nav">
    
      <a href="/2020/11/20/2020KCTF%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/" class="article-nav-link">
        <strong class="article-nav-caption">Newer</strong>
        <div class="article-nav-title">
          
            2020KCTF部分题目复现
          
        </div>
      </a>
    
    
      <a href="/2020/11/18/%E8%AE%B0%E4%B8%80%E6%AC%A1xss-challenge%E7%9A%84%E5%A4%8D%E7%8E%B0/" class="article-nav-link">
        <strong class="article-nav-caption">Older</strong>
        <div class="article-nav-title">记一次xss-challenge的复现</div>
      </a>
    
  </nav>


  


  
    
  <div class="gitalk" id="gitalk-container"></div>
  
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">

  
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

  
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>

  <script type="text/javascript">
    var gitalk = new Gitalk({
      clientID: 'b7d32ae2538e1a71f462',
      clientSecret: 'da0452b610458a4ccbc38598fb0d02f0eb9e653d',
      repo: 'gitalk',
      owner: 'Mount4in',
      admin: ['Mount4in'],
      // id: location.pathname,      // Ensure uniqueness and length less than 50
      id: md5(location.pathname),
      distractionFreeMode: false,  // Facebook-like distraction free mode
      pagerDirection: 'last'
    })

  gitalk.render('gitalk-container')
  </script>

  

</article>



</section>
  <footer class="footer">
  <div class="outer">
    <div class="float-right">
      <ul class="list-inline">
  
    <li><i class="fe fe-smile-alt"></i> <span id="busuanzi_value_site_uv"></span></li>
  
    <li><i class="fe fe-bookmark"></i> <span id="busuanzi_value_page_pv"></span></li>
  
</ul>
    </div>
    <ul class="list-inline">
      <li>&copy; 2023 Mount4in</li>
      <li>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></li>
      <li>Theme  <a href="https://github.com/zhwangart/hexo-theme-ocean" target="_blank" rel="noopener">Ocean</a></li>
    </ul>
  </div>
</footer>

</main>
<aside class="sidebar">
  <button class="navbar-toggle"></button>
<nav class="navbar">
  
    <div class="logo">
      <a href="/"><img src="/images/hexo.svg" alt="Mount4in"></a>
    </div>
  
  <ul class="nav nav-main">
    
      <li class="nav-item">
        <a class="nav-item-link" href="/">Home</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/archives">Archives</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/about">About</a>
      </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="Search">
        <i class="fe fe-search"></i>
        Search
      </a>
    </li>
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      <div class="totop" id="totop">
  <i class="fe fe-rocket"></i>
</div>
    </li>
    <li class="nav-item">
      
        <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
          <i class="fe fe-feed"></i>
        </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
</aside>

<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




  
<script src="/js/tocbot.min.js"></script>

  <script>
    // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
    tocbot.init({
      tocSelector: '.tocbot',
      contentSelector: '.article-entry',
      headingSelector: 'h1, h2, h3, h4, h5, h6',
      hasInnerContainers: true,
      scrollSmooth: true,
      positionFixedSelector: '.tocbot',
      positionFixedClass: 'is-position-fixed',
      fixedSidebarOffset: 'auto',
    });
  </script>



<script src="/js/ocean.js"></script>


</body>
</html>